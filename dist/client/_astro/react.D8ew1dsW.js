import{g as j,a as P,d as C,c as L,h as k}from"./chunk-K6S4O6NY.6jAmY9Ez.js";import{R as h,r as b}from"./index.CZlPm10g.js";import{j as c}from"./jsx-runtime.CYiYLu1p.js";var z={strict_mfa:{afterMinutes:10,level:"multi_factor"},strict:{afterMinutes:10,level:"second_factor"},moderate:{afterMinutes:60,level:"second_factor"},lax:{afterMinutes:1440,level:"second_factor"}},F=new Set(["first_factor","second_factor","multi_factor"]),I=new Set(["strict_mfa","strict","moderate","lax"]),B=t=>typeof t=="number"&&t>0,T=t=>F.has(t),V=t=>I.has(t),U=t=>t.replace(/^(org:)*/,"org:"),M=(t,e)=>{const{orgId:r,orgRole:o,orgPermissions:n}=e;return!t.role&&!t.permission||!r||!o||!n?null:t.permission?n.includes(U(t.permission)):t.role?U(o)===U(t.role):null},x=(t,e)=>{const{org:r,user:o}=W(t),[n,i]=e.split(":"),a=i||n;return n==="org"?r.includes(a):n==="user"?o.includes(a):[...r,...o].includes(a)},H=(t,e)=>{const{features:r,plans:o}=e;return t.feature&&r?x(r,t.feature):t.plan&&o?x(o,t.plan):null},W=t=>{const e=t?t.split(",").map(r=>r.trim()):[];return{org:e.filter(r=>r.split(":")[0].includes("o")).map(r=>r.split(":")[1]),user:e.filter(r=>r.split(":")[0].includes("u")).map(r=>r.split(":")[1])}},D=t=>{if(!t)return!1;const e=n=>typeof n=="string"?z[n]:n,r=typeof t=="string"&&V(t),o=typeof t=="object"&&T(t.level)&&B(t.afterMinutes);return r||o?e.bind(null,t):!1},$=(t,{factorVerificationAge:e})=>{if(!t.reverification||!e)return null;const r=D(t.reverification);if(!r)return null;const{level:o,afterMinutes:n}=r(),[i,a]=e,s=i!==-1?n>i:null,l=a!==-1?n>a:null;switch(o){case"first_factor":return s;case"second_factor":return a!==-1?l:s;case"multi_factor":return a===-1?s:s&&l}},G=t=>e=>{if(!t.userId)return!1;const r=H(e,t),o=M(e,t),n=$(e,t);return[r||o,n].some(i=>i===null)?[r||o,n].some(i=>i===!0):[r||o,n].every(i=>i===!0)},Y=({authObject:{sessionId:t,sessionStatus:e,userId:r,actor:o,orgId:n,orgRole:i,orgSlug:a,signOut:s,getToken:l,has:u,sessionClaims:d},options:{treatPendingAsSignedOut:m=!0}})=>{if(t===void 0&&r===void 0)return{isLoaded:!1,isSignedIn:void 0,sessionId:t,sessionClaims:void 0,userId:r,actor:void 0,orgId:void 0,orgRole:void 0,orgSlug:void 0,has:void 0,signOut:s,getToken:l};if(t===null&&r===null)return{isLoaded:!0,isSignedIn:!1,sessionId:t,userId:r,sessionClaims:null,actor:null,orgId:null,orgRole:null,orgSlug:null,has:()=>!1,signOut:s,getToken:l};if(m&&e==="pending")return{isLoaded:!0,isSignedIn:!1,sessionId:null,userId:null,sessionClaims:null,actor:null,orgId:null,orgRole:null,orgSlug:null,has:()=>!1,signOut:s,getToken:l};if(t&&d&&r&&n&&i)return{isLoaded:!0,isSignedIn:!0,sessionId:t,sessionClaims:d,userId:r,actor:o||null,orgId:n,orgRole:i,orgSlug:a||null,has:u,signOut:s,getToken:l};if(t&&d&&r&&!n)return{isLoaded:!0,isSignedIn:!0,sessionId:t,sessionClaims:d,userId:r,actor:o||null,orgId:null,orgRole:null,orgSlug:null,has:u,signOut:s,getToken:l}},S=new Error("Invariant: AsyncLocalStorage accessed in runtime where it is not available"),J=class{disable(){throw S}getStore(){}run(){throw S}exit(){throw S}enterWith(){throw S}};function N(){return new J}var q=N();function K(t){const e=t.get.bind(t);return h.useSyncExternalStore(t.listen,e,e)}var p=(t,e)=>{e=e||t.displayName||t.name||"Component",t.displayName=e;const r=o=>{const n=K(j([C,L],(i,a)=>i.isLoaded?a:null));return c.jsx(t,{...o,clerk:n},n?"a":"b")};return r.displayName=`withClerk(${e})`,r},R=t=>e=>{try{return h.Children.only(t)}catch{return`You've passed multiple children components to <${e}/>. You can only pass a single child component or text.`}},w=(t,e)=>(t||(t=e),typeof t=="string"&&(t=c.jsx("button",{type:"button",children:t})),t),y=t=>(...e)=>{if(t&&typeof t=="function")return t(...e)};p(({clerk:t,children:e,...r})=>{const{signUpFallbackRedirectUrl:o,forceRedirectUrl:n,fallbackRedirectUrl:i,signUpForceRedirectUrl:a,mode:s,...l}=r;e=w(e,"Sign in");const u=R(e)("SignInButton"),d=()=>{const g={forceRedirectUrl:n,fallbackRedirectUrl:i,signUpFallbackRedirectUrl:o,signUpForceRedirectUrl:a};if(t)return s==="modal"?t.openSignIn({...g,appearance:r.appearance}):t.redirectToSignIn({...g,signInFallbackRedirectUrl:i,signInForceRedirectUrl:n})},v={...l,onClick:async g=>(u&&typeof u=="object"&&"props"in u&&await y(u.props.onClick)(g),d())};return h.cloneElement(u,v)},"SignInButton");p(({clerk:t,children:e,...r})=>{const{redirectUrl:o="/",sessionId:n,...i}=r;e=w(e,"Sign out");const a=R(e)("SignOutButton"),s=()=>t?.signOut({redirectUrl:o,sessionId:n}),u={...i,onClick:async d=>(a&&typeof a=="object"&&"props"in a&&await y(a.props.onClick)(d),s())};return h.cloneElement(a,u)},"SignOutButton");p(({clerk:t,children:e,...r})=>{const{fallbackRedirectUrl:o,forceRedirectUrl:n,signInFallbackRedirectUrl:i,signInForceRedirectUrl:a,mode:s,...l}=r;e=w(e,"Sign up");const u=R(e)("SignUpButton"),d=()=>{const g={fallbackRedirectUrl:o,forceRedirectUrl:n,signInFallbackRedirectUrl:i,signInForceRedirectUrl:a};if(t)return s==="modal"?t.openSignUp({...g,appearance:r.appearance,unsafeMetadata:r.unsafeMetadata}):t.redirectToSignUp({...g,signUpFallbackRedirectUrl:o,signUpForceRedirectUrl:n})},v={...l,onClick:async g=>(u&&typeof u=="object"&&"props"in u&&await y(u.props.onClick)(g),d())};return h.cloneElement(u,v)},"SignUpButton");var _=t=>"mount"in t,O=t=>"open"in t,f=class extends h.PureComponent{portalRef=h.createRef();componentDidUpdate(t){!_(t)||!_(this.props)||(t.props.appearance!==this.props.props.appearance||t.props?.customPages?.length!==this.props.props?.customPages?.length)&&this.props.updateProps?.({node:this.portalRef.current,props:this.props.props})}componentDidMount(){this.portalRef.current&&(_(this.props)&&this.props.mount?.(this.portalRef.current,this.props.props),O(this.props)&&this.props.open?.(this.props.props))}componentWillUnmount(){this.portalRef.current&&(_(this.props)&&this.props.unmount?.(this.portalRef.current),O(this.props)&&this.props.close?.())}render(){return c.jsx(c.Fragment,{children:c.jsx("div",{ref:this.portalRef})})}},ot=p(({clerk:t,...e})=>c.jsx(f,{mount:t?.mountSignIn,unmount:t?.unmountSignIn,updateProps:t?.__unstable__updateProps,props:e}),"SignIn"),it=p(({clerk:t,...e})=>c.jsx(f,{mount:t?.mountSignUp,unmount:t?.unmountSignUp,updateProps:t?.__unstable__updateProps,props:e}),"SignUp"),at=p(({clerk:t,...e})=>c.jsx(f,{mount:t?.mountUserButton,unmount:t?.unmountUserButton,updateProps:t?.__unstable__updateProps,props:e}),"UserButton");p(({clerk:t,...e})=>c.jsx(f,{mount:t?.mountUserProfile,unmount:t?.unmountUserProfile,updateProps:t?.__unstable__updateProps,props:e}),"UserProfile");p(({clerk:t,...e})=>c.jsx(f,{mount:t?.mountOrganizationProfile,unmount:t?.unmountOrganizationProfile,updateProps:t?.__unstable__updateProps,props:e}),"OrganizationProfile");p(({clerk:t,...e})=>c.jsx(f,{mount:t?.mountOrganizationSwitcher,unmount:t?.unmountOrganizationSwitcher,updateProps:t?.__unstable__updateProps,props:e}),"OrganizationSwitcher");p(({clerk:t,...e})=>c.jsx(f,{mount:t?.mountOrganizationList,unmount:t?.unmountOrganizationList,updateProps:t?.__unstable__updateProps,props:e}),"OrganizationList");p(({clerk:t,...e})=>c.jsx(f,{open:t?.openGoogleOneTap,close:t?.closeGoogleOneTap,props:e}),"GoogleOneTap");p(({clerk:t,...e})=>c.jsx(f,{mount:t?.mountWaitlist,unmount:t?.unmountWaitlist,props:e}),"Waitlist");p(({clerk:t,...e})=>c.jsx(f,{mount:t?.mountPricingTable,unmount:t?.unmountPricingTable,props:e}),"PricingTable");var A=()=>new Promise(t=>{C.subscribe(({isLoaded:e})=>{e&&t(L.get())})}),Q=()=>async t=>{const e=await A();return e.session?e.session.getToken(t):null},X=()=>async(...t)=>(await A()).signOut(...t),E=({treatPendingAsSignedOut:t}={})=>{const e=tt(),r=b.useCallback(Q(),[]),o=b.useCallback(X(),[]),{userId:n,orgId:i,orgRole:a,orgPermissions:s,factorVerificationAge:l,sessionClaims:u}=e,d=b.useCallback(v=>G({userId:n,orgId:i,orgRole:a,orgPermissions:s,factorVerificationAge:l,features:u?.fea||"",plans:u?.pla||""})(v),[n,i,a,s,l,u]),m=Y({authObject:{...e,getToken:r,signOut:o,has:d},options:{treatPendingAsSignedOut:t}});if(!m)throw new Error("Invalid state. Feel free to submit a bug or reach out to support");return m};function Z(t,e){const r=t.get.bind(t);return b.useSyncExternalStore(t.listen,r,e||r)}function tt(){const t=P.get.bind(P);return Z(P,()=>typeof window>"u"?k(!1,{user:null,session:null,organization:null},q.getStore()):t())}function ut({children:t,treatPendingAsSignedOut:e}){const{userId:r}=E({treatPendingAsSignedOut:e});return r?null:t}function st({children:t,treatPendingAsSignedOut:e}){const{userId:r}=E({treatPendingAsSignedOut:e});return r?t:null}j(C,t=>t.isLoaded);p(({clerk:t,...e})=>(h.useEffect(()=>{t?.handleRedirectCallback(e)},[]),null),"AuthenticateWithRedirectCallback");export{st as S,at as U,ut as a,ot as b,it as c};
